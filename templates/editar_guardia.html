{% extends "base.html" %}
{% set bloqueado = guardia.estado == "Cerrado" %}

{% block content %}
<h3>‚úèÔ∏è Editar llamado</h3>

<form method="POST">

    <!-- ESTADO -->
    <div class="mb-3">
        <label class="form-label">Estado</label>
        <select name="estado" class="form-control"
            {% if bloqueado %}disabled{% endif %}>

            {% for e in ["Abierto", "En progreso", "Resuelto", "Cerrado"] %}
            <option value="{{ e }}"
                {% if guardia.estado == e %}selected{% endif %}>
                {{ e }}
            </option>
            {% endfor %}
        </select>
    </div>

    <!-- DESCRIPCI√ìN (EL BUG ESTABA AC√Å) -->
    <div class="mb-3">
        <label class="form-label">Descripci√≥n del llamado</label>
        <textarea class="form-control"
                  name="descripcion"
                  rows="3"
                  {% if bloqueado %}readonly{% endif %}>{{ guardia.descripcion }}</textarea>
    </div>

   

    <!-- DERIVADO -->
    <div class="form-check mb-3">
        <input class="form-check-input"
               type="checkbox"
               name="derivado"
               {% if guardia.derivado %}checked{% endif %}
               {% if bloqueado %}disabled{% endif %}>
        <label class="form-check-label">
            Derivado
        </label>
    </div>

    <!-- DERIVADO A -->
    <div class="mb-3">
        <label class="form-label">Derivado a</label>
        <input class="form-control"
               name="derivado_a"
               value="{{ guardia.derivado_a or '' }}"
               {% if bloqueado %}readonly{% endif %}>
    </div>

    {% if not bloqueado %}
        <button class="btn btn-success">
            üíæ Guardar cambios
        </button>
    {% endif %}

    <a href="/" class="btn btn-secondary">
        Volver
    </a>

</form>
{% endblock %}
